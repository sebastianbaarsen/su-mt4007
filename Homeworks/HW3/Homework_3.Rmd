---
output:
  pdf_document: default
  html_document: default
---
```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(patchwork)
library(GGally)

iris <- read.csv('https://raw.githubusercontent.com/su-mt4007/data/refs/heads/main/IRIS.csv')

iris


# Sepal length gainst petal length
ggplot(iris, aes(sepal_length,petal_length, color = species))+
  geom_point(size = 2)+
  geom_smooth(se = FALSE,method='lm')+
   labs(
    title = "Sepal Length vs Petal Length",
    x = "Sepal Length",
    y = "Petal Length",
    color = 'Species')+
  theme_minimal()

# Sepal width against petal width
ggplot(iris, aes(sepal_width,petal_width, color = species))+
  geom_point(size = 2)+
  geom_smooth(se = FALSE,method='lm')+
   labs(
    title = "Sepal Width vs Petal Width",
    x = "Sepal Width",
    y = "Petal Width",
    color = 'Species')+
  theme_minimal()
```


```{r}
# Species vs Sepal Width
p1 <- ggplot(iris, aes(species,sepal_width,fill= species))+
  geom_boxplot()+
  labs(title = 'Species vs Sepal Width',
       x = 'Species',
       y = 'Sepal Width')+
  theme(axis.text.x = element_text(size = 5), 
  axis.text.y = element_text(size = 5))



# Species vs Sepal Length
p2 <- ggplot(iris, aes(species,sepal_length,fill= species))+
  geom_boxplot()+
  labs(title = 'Species vs Sepal Length',
       x = 'Species',
       y = 'Sepal Length')+
  theme(axis.text.x = element_text(size = 5), 
  axis.text.y = element_text(size = 5))



# Species vs Sepal Width
p3 <- ggplot(iris, aes(species,petal_width,fill= species))+
  geom_boxplot()+
  labs(title = 'Species vs Petal Width',
       x = 'Species',
       y = 'Petal Width',)  +
  theme(axis.text.x = element_text(size = 5), 
    axis.text.y = element_text(size = 5))



# Species vs Petal Length
p4 <- ggplot(iris, aes(species,petal_length,fill= species))+
  geom_boxplot()+
  labs(title = 'Species vs Petal Length',
       x = 'Species',
       y = 'Petal Length') +
  theme(axis.text.x = element_text(size = 5), 
  axis.text.y = element_text(size = 5)) 



(p1|p2)/(p3|p4)

```
```{r, message=FALSE}
iris
ggpairs(iris,columns = 1:4,aes(color = species,alpha = 0.5),
        upper = list(continuous = "points"))
```

```{r}
birds <- read.csv('true.txt')

str(birds)

```



# top 3 vanligaste
```{r, warning=FALSE}
counted_birds <- birds %>% 
  group_by(Artnamn) %>% 
  select(Artnamn,Antal) %>% 
  mutate(Antal = as.numeric(Antal)) %>% 
  summarize(count=sum(Antal,na.rm=TRUE)) %>% 
  arrange(desc(count))
  
head(counted_birds,3)
```
# Månads fördelnnigen
```{r, warning=FALSE, message=FALSE}


prelevent_birds <- birds %>% 
  group_by(Artnamn) %>% 
  mutate(Månad = as.numeric(sapply(strsplit(Startdatum,'-'),`[`, 2),na.rm=TRUE))%>% 
  mutate(Antal = ifelse( is.na(as.numeric(Antal)), NA, as.numeric(Antal))) %>% 
  
  select(Artnamn,Antal,Månad) %>% 
  group_by(Artnamn,Månad) %>% 
  summarize(Antal = sum(Antal,na.rm =TRUE)) %>% 
  filter(Artnamn %in%  c("Grönsiska","Sothöna","Gräsand"))
  

prelevent_birds

ggplot(prelevent_birds, aes(x = Månad, y = Antal, color = Artnamn)) +
  geom_histogram(stat='identity',alpha = 0.5)+
  labs(
    title = "Antal fåglar per månad",
    x = "Månad",
    y = "Antal observationer",
    color = "Artnamn")




```
#rearest birds
```{r}
reareast_birds <- counted_birds %>%
  arrange(count)

head(reareast_birds,20)
```

# Rapportörer som är observerat flest Antal fåglar per tillfälle/ med mest 'tur'.

Not balance in terms of tillfällen per rapportör. 
```{r,warning=FALSE,message=FALSE}

effective <- birds %>% 
  select(Rapportör,Antal,Startdatum) %>% 
  mutate(Antal = ifelse( is.na(as.numeric(Antal)), NA, as.numeric(Antal))) %>% 
  group_by(Rapportör,Startdatum) %>% 
  summarize(Antal = sum(Antal,na.rm=TRUE)) %>% 
  ungroup(Startdatum) %>% 
  summarize(Totala_antal_fåglar =  sum(Antal),Dagar = n()) %>% 
  mutate(Fågel_per_dag = round(Totala_antal_fåglar/Dagar,1)) %>% 
  arrange(desc(Fågel_per_dag))


head(effective,5)

```
observed bird by the hour during the day.
```{r, warning=FALSE}
library(hms)
 birds

by_time <- birds %>%
  select(Starttid, Antal) %>%
  mutate(Antal = ifelse( is.na(as.numeric(Antal)), NA, as.numeric(Antal))) %>%
  mutate(Hour = as.numeric(sapply(strsplit(Starttid,':'),`[`, 1),na.rm=TRUE)) %>% 
  group_by(Hour) %>%
  summarize(Antal = sum(Antal, na.rm=TRUE)) %>% 
  filter(Hour != 'NA')

by_time
```
Is the above a fair way of determine if you are more likely to spot some birds during the middle of the day? What is the distribution of "fågel-skådning" time?

```{r}
birds
birds %>% 
  select(Starttid,Sluttid,Startdatum,Slutdatum) %>% 
  filter(Startdatum != Slutdatum)
```





